<!doctype html>
<html lang="tr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>E-posta Doğrulama</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="../css/styles.css">
</head>
<body>
  <nav class="navbar navbar-expand-lg navbar-dark mainnav" id="mainNavbar">
    <div class="container-fluid"><a class="navbar-brand" href="../index.html">Nara Müzik</a></div>
  </nav>
  <main class="container mt-4">
    <div id="state" class="alert alert-info">Doğrulama yapılıyor...</div>
  </main>
  <select id="language-toggle">
    <option value="en">EN</option>
    <option value="tr">TR</option>
  </select>
  <script>
    (async ()=>{
      const BACKEND_BASE = location.hostname.includes('localhost')? 'http://localhost:4000':'https://naramusic.onrender.com';
      const params = new URLSearchParams(location.search);
      const uid = params.get('uid');
      const token = params.get('token');
      const el = document.getElementById('state');
      try{
        const r = await fetch(`${BACKEND_BASE}/api/auth/verify`, { method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify({ uid, token }) });
        const data = await r.json();
        if (data.error){ el.className='alert alert-danger'; el.textContent = 'Doğrulama başarısız: ' + data.error; return; }
        el.className='alert alert-success'; el.textContent = 'E-posta doğrulandı! Ana sayfaya yönlendiriliyorsunuz...';
        setTimeout(()=>{ location.href = '../index.html'; }, 1500);
      }catch(err){ el.className='alert alert-danger'; el.textContent = 'Sunucu hatası.'; }
    })();
  </script>
</body>
</html>


